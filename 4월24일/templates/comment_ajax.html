<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>AJAX ëŒ“ê¸€ ì‹œìŠ¤í…œ</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>

<h2>ğŸ’¬ ëŒ“ê¸€ ì‘ì„±</h2>

<form id="commentForm">
    <textarea id="commentInput" name="content" rows="4" cols="50" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea><br>
    <button type="submit">ëŒ“ê¸€ ë“±ë¡</button>
</form>

<hr>

<h3>ğŸ“ƒ ëŒ“ê¸€ ëª©ë¡</h3>
<div id="commentList">
    <!-- ëŒ“ê¸€ì´ ì—¬ê¸°ì— í‘œì‹œë¨ -->
</div>

<script>
    $(document).ready(function () {
        // ëŒ“ê¸€ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
        loadComments();

        // ëŒ“ê¸€ ë“±ë¡ ì´ë²¤íŠ¸ ì²˜ë¦¬
        $("#commentForm").on("submit", function (e) {
            e.preventDefault();

            const commentText = $("#commentInput").val();

            $.post("/add_comment", { content: commentText }, function (response) {
                alert(response);  
                $("#commentInput").val("");  
                loadComments();              
            });
        });

        // ëŒ“ê¸€ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
        function loadComments() {
            $.get("/get_comments", function (data) {
                let html = "";
                data.forEach(function (comment) {
                    html += "<div class='comment'>" + comment + "</div>";
                });
                $("#commentList").html(html);
            });
        }
    });
</script>

</body>
</html>
